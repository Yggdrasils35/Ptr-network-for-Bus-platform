"""
Combine the dataset which is generated by Multi.py
"""

import numpy as np
import torch


DataSet = []
for i in range(4):
    file = './DataSets/trainset' + str(i+1) + '.npy'
    dataF = np.load(file, allow_pickle=True)
    for data in dataF:
        solution = list(data['Solution'])
        solution.insert(0, 0)
        solution = torch.tensor(solution)
        nodes = data['Points'][:, :2]
        weights = data['Points'][:, 2]
        weights = weights[:, np.newaxis] / 30
        data = torch.cat([nodes, weights], dim=1)
        data_dict = {'Points': data, 'Solution': solution}
        DataSet.append(data_dict)
np.save('./DataSets/TrainSet.npy', DataSet)

# data1 = np.load('./DataSets/TrainSet.npy', allow_pickle=True)
# data2 = np.load('./DataSets/TspData.npy', allow_pickle=True)
# for data in data1:
#     solution = data['Solution']
#     nodes = data['Points']
#     data_dict = {'Points': nodes, 'Solution': solution}
#     DataSet.append(data_dict)
# for data in data2:
#     solution = data['Solution']
#     nodes = data['Points']
#     data_dict = {'Points': nodes, 'Solution': solution}
#     DataSet.append(data_dict)
# np.save('./DataSets/DataSet.npy', DataSet)
# dataset = np.load('./DataSets/DataSet.npy', allow_pickle=True)
# print(dataset.shape)
# print(dataset[0])